# REVLN_WORKFLOW

## ç›®çš„
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€GitHub Copilot ãŒä¼šè©±çŠ¶æ…‹ã®ãƒªã‚»ãƒƒãƒˆå¾Œã§ã‚‚ä½œæ¥­ã‚’ç¶™ç¶šã§ãã‚‹ã‚ˆã†ã«ã€
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚è¦ãŠã‚ˆã³ä½œæ¥­ãƒ­ã‚°ã‚’ãƒªãƒã‚¸ãƒˆãƒªä¸Šã«æ’ä¹…çš„ã«ä¿å­˜ã™ã‚‹ç›®çš„ã§ä½œæˆã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚

---
## ãƒ«ãƒ¼ãƒ«
- ãƒãƒ£ãƒƒãƒˆã®ä¼šè©±ã«ã¯æ—¥æœ¬èªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
- æŒ‡ç¤ºã‚„è¦æœ›ã«ä¸æ˜ç‚¹ã‚„æ··ä¹±ãŒã‚ã‚‹å ´åˆã¯ã€ä½œæ¥­ã«å…¥ã‚‹å‰ã«å¿…ãšç¢ºèªã™ã‚‹ã“ã¨ã€‚
- æ‰‹é †ã‚„æ®µå–ã‚Šã¯Step By Stepã§é€²ã‚ã‚‹ã“ã¨ã€‚
- è¿”ç­”ã¯ç°¡æ½”ã‹ã¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã®è¡¨ç¤ºã¯ã—ãªã„ã€ææ¡ˆã®è¡¨ç¤ºã¯å¿…è¦ãªã„ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ææ¡ˆã¯ã—ãªã„ã€‚
- æŒ‡ç¤ºãŒã‚ã‚‹ã¾ã§ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ã®å¤‰æ›´ã€ææ¡ˆã¯ã—ãªã„äº‹ã€‚
- ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯ã€æœ€å°é™ã®å·®åˆ†ã«ã¨ã©ã‚ã‚‹ã“ã¨ã€‚
- ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã¯ã€ãƒ¦ãƒ¼ã‚¶ã®æ‰¿èªï¼ˆã€Œæ”¹ä¿®å®Ÿæ–½ã€ã®æŒ‡ç¤ºï¼‰ã‚’å¾—ã‚‹ã¾ã§çµ¶å¯¾ã«å®Ÿè¡Œã—ãªã„ã“ã¨ã€‚
- ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã®å‰ã«ã€ã©ã®ã‚ˆã†ãªæ„å›³ã§ã©ã“ã«ã€ã©ã†å¤‰æ›´ã™ã‚‹ã‹ã‚’ç¤ºã™ã“ã¨ã€‚
- ãƒ­ã‚°ãŒè²¼ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸå ´åˆã¯ã€ä½•ãŒèµ·ããŸã®ã‹èª¬æ˜ã—ã€ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹å ´åˆã¯ãã®å†…å®¹ã¨åŸå› ã€å¯¾å‡¦æ³•ã‚’æç¤ºã™ã‚‹ã“ã¨ã€‚
- Gitã¸ã®æ›¸ãè¾¼ã¿æ“ä½œçµ¶å¯¾ã«è¡Œã‚ãªã„ã“ã¨ã€‚
- ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§`GitHub CopilotãŒæ›´æ–°`ãŒå¤‰æ›´ã§ãã‚‹ã®ã¯ã€Œç¾çŠ¶ã‚µãƒãƒªã€ã¨ã€Œä½œæ¥­ãƒ­ã‚°ã€ã®ã¿ã€‚
- ã‚³ãƒ¡ãƒ³ãƒˆã¯ç°¡æ½”ã«ã€è‹±èªã€æ—¥æœ¬èªã®é †ã§è¨˜è¼‰ã™ã‚‹ã“ã¨ã€‚
- ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ monorepo ãªã®ã§ã€åŒåã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰±ã†æ™‚ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã‚’æ˜ç¤ºã™ã‚‹ã“ã¨ã€‚
- åŸå‰‡ import ã‚’å„ªå…ˆã—ã€å¯¾å¿œã—ãªã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿ require ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
> ï¼Šï¼Šï¼Šï¼Š ä»¥ä¸Šã®ãƒ«ãƒ¼ãƒ«ã‚’å¿…ãšå®ˆã‚‹ã“ã¨ã€ã™ãå¿˜ã‚Œã‚‹ã‹ã‚‰æ°—ã‚’ã¤ã‘ã‚ ï¼Šï¼Šï¼Šï¼Š

---
## æ³¨æ„äº‹é …ï¼ˆçµ¶å¯¾ã®æ³¨æ„ã‚’ã¯ã‚‰ã†ã“ã¨ï¼ï¼ï¼ï¼‰
- monorepo ã§ã‚ã‚‹ã“ã¨ã‚’å¿˜ã‚Œã¦é–¢ä¿‚ã®ãªã„ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã—ã‚³ãƒ¼ãƒ‰ç ´å£Šã—ã¦ã—ã¾ã†äº‹æ•…ãŒåº¦ã€…ç™ºç”Ÿã—ã¦ã„ã‚‹
- npmã®å…¬é–‹è¦ä»¶ãŒã‚ã‚‹ã®ã§ã€testã¨npmå…¬é–‹çŠ¶æ…‹ã§importãƒ‘ã‚¹ãŒå¤‰ã‚ã£ã¦ã—ã¾ã†

---
## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚è¦
MongoDB Atlas ãŒ App Services ã‚’å»ƒæ­¢ã—ãŸã“ã¨ã‚’å—ã‘ã¦ã€ãã®ä»£æ›¿æ‰‹æ®µã‚’æä¾›ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã™ã‚‹ã€‚
MongoDB Atlas / MongoDB ã¨ã®æ¥ç¶šã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã®ä»•çµ„ã¿ã®ã¿ã‚’å®Ÿè£…ã—ã€æ—¢å­˜ã® Realm ä¾å­˜ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæœ€å°é™ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã§ç§»è¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

---
## æŠ€è¡“æ§‹æˆ

### ä½¿ç”¨æŠ€è¡“
- è¨€èª: TypeScript
- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†: pnpm
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š: MongoDB Node.js Driver
- èªè¨¼: JSON Web Tokens (JWT)
- ãƒ†ã‚¹ãƒˆ: Jest

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ§‹æˆã¨å½¹å‰²
ãƒ¢ãƒãƒ¬ãƒ (monorepo) ã‚’ä½¿ç”¨ã—ã€æ¬¡ã®3ã¤ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹
- revlm-serverï¼šMongoDB Atlas / MongoDB ã¨æ¥ç¶šã—ã€èªè¨¼ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆä»²ä»‹ã‚’æä¾›
- revlm-clientï¼šã‚¢ãƒ—ãƒªã«çµ„ã¿è¾¼ã‚“ã§ä½¿ç”¨ã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€revlm-server ã«æ¥ç¶šã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ“ä½œã‚’è¡Œã†
- revlm-sharedï¼šå‹å®šç¾©ã‚„ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ãªã©ã€revlm-server ã¨ revlm-client ã®å…±é€šã§ä½¿ç”¨

å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ç‹¬ç«‹ã—ãŸ npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å…¬é–‹å¯èƒ½ãªè¨­è¨ˆ

---
## ã‚´ãƒ¼ãƒ«ã®å®šç¾©
1. `build â†’ start â†’ test` ã¾ã§ã‚¨ãƒ©ãƒ¼ç„¡ãæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã€‚
2. å…¬é–‹ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆ`dist` ã¨ `exports`ï¼‰ã‚’ npm ã«é…å¸ƒã—ã€æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã€‚

---
## ç¾çŠ¶ã‚µãƒãƒªï¼ˆæœ€æ–°ãƒ»æ©Ÿæ¢°å¯èª­ï¼‰
# Date: 2025-11-10
- revlm-shared.ãƒ“ãƒ«ãƒ‰: OK
- revlm-shared.dist_å†…å®¹: ["dist/index.d.ts","dist/auth-token.d.ts","dist/models/user-types.d.ts"]
- revlm-shared.exports: ã‚µãƒ–ãƒ‘ã‚¹ã« types æŒ‡å®šã‚ã‚Š (auth-token, models/*)
- revlm-shared.tsconfig: composite=true, declaration=true, module=NodeNext, moduleResolution=NodeNext
- revlm-server.tsconfig: module=NodeNext, moduleResolution=NodeNext, paths ãŒ shared dist ã‚’æŒ‡ã™, references ã« ../revlm-shared ã‚’å«ã‚€
- root.tsconfig: module=NodeNext, moduleResolution=NodeNext, paths ã« @kedaruma ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚ã‚Š
- server.ãƒ“ãƒ«ãƒ‰: OK (CLI ã® tsc ã‚’ pnpm çµŒç”±ã§å®Ÿè¡Œã—æˆåŠŸ)
- IDE_ã‚¨ãƒ©ãƒ¼: ["TS2307 @kedaruma/revlm-shared/models/user-types","TS2307 @kedaruma/revlm-shared/auth-token"]
- IDE_ã‚¨ãƒ©ãƒ¼_å‚™è€ƒ: "dist/*.d.ts ã¯å­˜åœ¨ã™ã‚‹ãŒ tsserver ã® moduleResolution / paths ã®è§£æ±ºã§è¦‹ãˆãªã„ï¼ˆWebStorm ã® tsserver è¨­å®šã¾ãŸã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å¯èƒ½æ€§ï¼‰"
- ç¾åœ¨ã®imports: ["@kedaruma/revlm-shared/models/user-types","@kedaruma/revlm-shared/auth-token"]
- ç›´è¿‘ã®å®Ÿæ–½äº‹é …: ["shared ã® tsconfig ã‚’ composite/declaration è¨­å®šã«å¤‰æ›´","shared ã« build ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ãƒ»ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ","tsconfig ã‚’ NodeNext ã«æ•´åˆ","server ã« paths ã¨ references ã‚’è¿½åŠ ","tsc -b ã‚’å®Ÿè¡Œ"]
- æ¬¡å„ªå…ˆã‚¿ã‚¹ã‚¯: ["ãƒ¦ãƒ¼ã‚¶: WebStorm ã® TypeScript ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹• / ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç‰ˆ TypeScript ã‚’ä½¿ç”¨ã™ã‚‹","æœªè§£æ±ºãªã‚‰ root paths ã‚’ dist å„ªå…ˆã«æ›´æ–°ã—ã¦ tsserver å†èµ·å‹• (ç§ãŒå¯¾å¿œå¯èƒ½)"]

---
## ã‚´ãƒ¼ãƒ«ã¾ã§ã®ä½œæ¥­é …ç›®
- [ ] revlm-server
  - [x] `packages/revlm-server` ã§ pnpm build ãŒæˆåŠŸã™ã‚‹ã“ã¨ï¸
  - [x] `packages/revlm-server` ã§ pnpm test ãŒæˆåŠŸã™ã‚‹ã“ã¨
    - [x] å½“åˆã‚µãƒ¼ãƒã®å®Ÿè£…ã¯ server.ts ã®ã¿ã§å®Œçµã—ã¦ã„ãŸãŒã€ã‚µãƒ¼ãƒã®èµ·å‹•éƒ¨åˆ†ã‚’ start.js ã¨ã—ã¦åˆ†é›¢ã€æ©Ÿèƒ½éƒ¨åˆ† server.ts ã«é›†ç´„ã™ã‚‹è¨­è¨ˆã«å¤‰æ›´
    - [x] ãƒ“ãƒ«ãƒ‰ã¯é€šã‚‹ãŒIDEä¸Šã§importã®ãƒ‘ã‚¹ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å•é¡Œã®è§£æ¶ˆ
    - [x] server.ts ã¨ start.js ã®åˆ†é›¢ã«ä¼´ã„ã€ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ãŒå¿…è¦
      - [x] auth.test.ts
      - [x] revlm-gate.test.ts
      - [x] token.test.ts
  - [ ] `packages/revlm-server` ã§ npm å…¬é–‹ç‰©ã®æ¤œè¨¼
- [ ] revlm-client
  - [x] `packages/revlm-client` ã§ pnpm build ãŒæˆåŠŸã™ã‚‹ã“ã¨
  - [x] `packages/revlm-client` ã§ pnpm test ãŒæˆåŠŸã™ã‚‹ã“ã¨
    - [x] Revlm.test.ts
    - [x] RevlmCollection.test.ts
  - [ ] `packages/revlm-client` ã§ npm å…¬é–‹ç‰©ã®æ¤œè¨¼ï¼ˆ`pnpm pack` â†’ åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ import/tsc ã‚’ç¢ºèªï¼‰
- [ ] revlm-shared
  - [x] `packages/revlm-shared` ã§ pnpm build ãŒæˆåŠŸã™ã‚‹ã“ã¨
  - [x] `packages/revlm-shared` ã§ pnpm test ãŒæˆåŠŸã™ã‚‹ã“ã¨
    - [ ] auth-token.test.ts
  - [ ] `packages/revlm-shared` ã‚’ `composite` åŒ–ã—å‹å®šç¾©ï¼ˆ`.d.ts`ï¼‰ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨
  - [x] `revlm-server` / `revlm-client` å´ã§ `revlm-shared` ã‚’å‚ç…§ã—ã¦ãƒ“ãƒ«ãƒ‰ãƒ»å‹ãƒã‚§ãƒƒã‚¯ãŒé€šã‚‹ã“ã¨
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `root`
  - [ ] pnpm install ã§ä¾å­˜ãŒæ­£ã—ãå¾©å…ƒã•ã‚Œã‚‹ã“ã¨
  - [ ] pnpm build ã§å…¨ä½“ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã™ã‚‹ã“ã¨
  - [ ] pnpm test ã§å…¨ä½“ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã“ã¨
  - [ ] pnpm install ã§ä¾å­˜ãŒæ­£ã—ãå¾©å…ƒã•ã‚Œã‚‹ã“ã¨
  - [ ] å…¨ä½“ã®npmã®å…¬é–‹ç‰©ã®æ¤œè¨¼ï¼ˆ`pnpm pack` â†’ åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ import/tsc ã‚’ç¢ºèªï¼‰

## ä»Šã‚„ã£ã¦ã‚‹ä½œæ¥­
> å‡¡ä¾‹: âœ…ï¸å®Œäº†ã€€ğŸ”²æœªç€æ‰‹ã€€ğŸƒä½œæ¥­ä¸­

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ã§ pnpm install ã‚’å®Ÿè¡Œã—ãŸã‚‰ã€ä»¥ä¸‹ã®å­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ pnpm install ã‚’å‘¼ã³å‡ºã— node_modules ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
revlm-client
revlm-server
revlm-shared

---
## ä½œæ¥­ãƒ­ã‚°ï¼ˆGitHub CopilotãŒè¿½åŠ ï¼‰
> ï¼Šï¼Šï¼Šï¼Š ç°¡æ½”ã«ç¾åœ¨ã®é€²æ—ã¨å•é¡Œç‚¹ã‚’ã¾ã¨ã‚ã‚‹äº‹

- 2025-10-xx :
  - æ”¹ä¿®å†…å®¹2
- 2025-11-09 :
  - ãƒ«ãƒ¼ãƒ«ã¨æ³¨æ„äº‹é …ã‚’å†ç¢ºèªã—ã€ä»Šå¾Œã®è¡Œå‹•æ–¹é‡ã‚’æ˜ç¤ºã—ã¾ã—ãŸï¼ˆã‚³ãƒ¼ãƒ‰å¤‰æ›´ã¯ãƒ¦ãƒ¼ã‚¶æ‰¿èªå‰ã«è¡Œã„ã¾ã›ã‚“ï¼‰ã€‚
  - æ¬¡ã®æœ€å°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: ãƒ¦ãƒ¼ã‚¶ã®è¨±å¯ã§ `pnpm install` ã‚’å®Ÿè¡Œã—ã€ä¾å­˜å¾©å…ƒã¨ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’åé›†ã—ã¾ã™ã€‚

- 2025-11-10 :
  - ä»Šæ—¥ã®å®Ÿæ–½å†…å®¹:
    - `packages/revlm-shared` ã‚’ composite/declaration åŒ–ã—ã€`dist/*.d.ts` ã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ãƒ“ãƒ«ãƒ‰è¨­å®šã‚’è¿½åŠ ï¼ˆtsconfig/package.json ã®æœ€å°å¤‰æ›´ï¼‰ã€‚
    - `packages/revlm-shared` ã®ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã—ã€`dist` ã«å‹å®šç¾©ã¨ãƒ“ãƒ«ãƒ‰æˆæœç‰©ãŒç”Ÿæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã€‚
    - ãƒ«ãƒ¼ãƒˆã¨ `packages/revlm-server` ã® `tsconfig.json` ã‚’ NodeNext ã«æ•´åˆã•ã›ã€`revlm-server` ã« `paths` ã¨ `references` ã‚’è¿½åŠ ã—ã¦å‹è§£æ±ºã‚’è£œåŠ©ã€‚
    - `packages/revlm-server/src/server.ts` ã® import ã‚’ä¸€æ™‚çš„ã«ç›¸å¯¾ pathâ†’`@kedaruma` ã«æˆ»ã™ãªã©æœ€å°èª¿æ•´ã‚’è¡Œã„ã€ãƒ“ãƒ«ãƒ‰ãŒé€šã‚‹çŠ¶æ…‹ã«æ•´å‚™ã€‚
  - æ®‹èª²é¡Œï¼ˆæœªè§£æ±ºï¼‰:
    - IDEï¼ˆWebStormï¼‰ä¸Šã§ `server.ts` ã®ä¸‹è¨˜2è¡Œã« TS2307 ãŒæ®‹ã‚‹:
      - `import { User } from '@kedaruma/revlm-shared/models/user-types';`
      - `import { AuthServer } from '@kedaruma/revlm-shared/auth-token';`
      - å‚™è€ƒ: CLI ã® tsc/pnpm ãƒ“ãƒ«ãƒ‰ã¯é€šã‚‹ãŒ tsserver ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è§£æ±ºãŒã¾ã å·®ç•°ã‚’ç¤ºã™ï¼ˆå¯¾å¿œæ¸ˆã¿ã®å¯¾ç­–: module/nodeNext ã®æ•´åˆã€paths/references ã®è¿½åŠ ï¼‰ã€‚
  - æ˜æ—¥ã®å„ªå…ˆã‚¿ã‚¹ã‚¯:
    1. WebStorm ã® TypeScript ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•ã¨ã€ŒUse workspace versionã€ã®ç¢ºèªï¼ˆãƒ¦ãƒ¼ã‚¶å´æ“ä½œï¼‰ã€‚
    2. ãã‚Œã§ã‚‚è§£æ¶ˆã—ãªã„å ´åˆã€ãƒ«ãƒ¼ãƒˆ `tsconfig.json` ã® `paths` ã‚’ `dist` å„ªå…ˆã«ã™ã‚‹ã‹ã€IDE ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–ã‚’è©¦ã™ã€‚å¿…è¦ãªã‚‰ç§ãŒ `paths` ã‚’æ›´æ–°ã—ã¾ã™ã€‚
    3. å¼•ãç¶šã `revlm-server` ã®å‹è­¦å‘Š/è­¦å‘Šã®æ•´ç†ï¼ˆçŸ­ç¸®å¯èƒ½ import ã®è§£æ¶ˆãªã©ï¼‰ã€‚

- 2025-11-20 :
  - ä»Šæ—¥ã®å®Ÿæ–½å†…å®¹:
    - `packages/revlm-client` ã®ãƒ“ãƒ«ãƒ‰æˆåŠŸã‚’ç¢ºèªï¼ˆtsup ã«ã‚ˆã‚‹ CJS/ESM/å‹å®šç¾©ç”Ÿæˆï¼‰ã€‚
    - `packages/revlm-client` ã® package.json ã‚’å…¬é–‹å¯¾å¿œã¸ä¿®æ­£:
      - `private: false` ã«å¤‰æ›´ï¼ˆå…¬é–‹å¯èƒ½ã«ï¼‰
      - `main`/`module` ã‚’å®Ÿéš›ã®ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`dist/index.js`/`dist/index.mjs`ï¼‰ã¸ä¿®æ­£
      - `exports` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ï¼ˆimport/require ä¸¡å¯¾å¿œãƒ»å‹å®šç¾©ã‚’æ˜ç¤ºï¼‰
      - `sideEffects: false` ã‚’è¿½åŠ ï¼ˆTree-shaking å¯¾å¿œï¼‰
    - `revlm-client` ã®ãƒ†ã‚¹ãƒˆã‚’ setupTestEnvironment æ–¹å¼ã¸ãƒªãƒ•ã‚¡ã‚¯ã‚¿:
      - `Revlm.test.ts` ã¨ `RevlmCollection.test.ts` ã‚’ `setupTestEnvironment`/`cleanupTestEnvironment` ã‚’ä½¿ã†ã‚ˆã†å¤‰æ›´
      - ãƒ†ã‚¹ãƒˆè¨­å®šã¯ `__tests__/test.env` ã‚’èª­ã¿è¾¼ã‚€æ–¹å¼ã«çµ±ä¸€
    - `revlm-server` å´ã®æ•´å‚™:
      - `setupTestMongo.ts` ã‚’æ”¹å–„ã—ãƒ†ã‚¹ãƒˆç”¨ã®ç’°å¢ƒæ§‹ç¯‰ãƒ˜ãƒ«ãƒ‘ã‚’æä¾›ï¼ˆMongoMemoryServer ã®èµ·å‹•ã‚’å«ã‚€ï¼‰
      - `server.ts` å´ã§ãƒãƒ¼ãƒˆæ­£è¦åŒ–ã‚’è¿½åŠ ï¼ˆæœªæŒ‡å®š/NaN â†’ 0 ã‚’æ¡ç”¨ã—ã¦ç©ºããƒãƒ¼ãƒˆå‰²å½“ï¼‰
    - `revlm-shared` ã®ã‚¨ãƒ³ãƒˆãƒªã§ `.js` æ‹¡å¼µå­ã‚’å‰Šé™¤ã—ã¦ Jest/ts-jest ã‹ã‚‰è§£æ±ºã§ãã‚‹ã‚ˆã†ä¿®æ­£
    - å¤‰æ›´å¾Œã«ãƒ“ãƒ«ãƒ‰ & ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€`revlm-server` ã®ãƒ†ã‚¹ãƒˆ (4 suites) ã¨ `revlm-client` ã®ä¸»è¦ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèª
  - æ¬¡ã®å„ªå…ˆã‚¿ã‚¹ã‚¯:
    1. `packages/revlm-client` ã® npm å…¬é–‹ç‰©ã®æ¤œè¨¼ï¼ˆ`pnpm pack` â†’ åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ import/tsc ã‚’ç¢ºèªï¼‰
    2. `packages/revlm-server` / `packages/revlm-shared` ã® npm å…¬é–‹æº–å‚™
    3. ãƒ«ãƒ¼ãƒˆã§ã®å…¨ä½“ãƒ“ãƒ«ãƒ‰ & å…¬é–‹ç‰©æ¤œè¨¼

## ã‚³ãƒãƒ³ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆï¼ˆã‚³ãƒ”ãƒšã§å®Ÿè¡Œï¼‰
### ä¾å­˜å¾©å…ƒ
```bash
pnpm install
```

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å˜ä½“ãƒ“ãƒ«ãƒ‰
```bash
pnpm --filter @kedaruma/revlm-shared run build
pnpm --filter @kedaruma/revlm-server run build
```

### ãƒ†ã‚¹ãƒˆ
```bash
# auth.test.ts ã®å®Ÿè¡Œ
pnpm exec jest packages/revlm-server/src/__tests__/auth.test.ts --runInBand --verbose
pnpm exec jest packages/revlm-server/src/__tests__/token.test.ts --runInBand --verbose
pnpm exec jest packages/revlm-server/src/__tests__/revlm-gate.test.ts --runInBand --verbose
pnpm exec jest packages/revlm-server/src/__tests__/ --runInBand --verbose

pnpm exec jest packages/revlm-client/src/__tests__/Revlm.test.ts --runInBand --verbose
pnpm exec jest packages/revlm-client/src/__tests__/RevlmCollection.test.ts --runInBand --verbose
pnpm exec jest packages/revlm-client/src/__tests__/ --runInBand --verbose
```

### Project Referencesï¼ˆå…¨ä½“ãƒ“ãƒ«ãƒ‰ï¼‰
```bash
pnpm -w run build
```

### ãƒ­ãƒ¼ã‚«ãƒ«å…¬é–‹ç‰©æ¤œè¨¼
```bash
cd packages/revlm-shared
pnpm pack
mkdir /tmp/revlm-test && cd /tmp/revlm-test
pnpm init -y
pnpm add /path/to/revlm-shared-1.0.0.tgz
# test ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ import ã¨å®Ÿè¡Œï¼ˆã¾ãŸã¯ tscï¼‰ã‚’æ¤œè¨¼ã™ã‚‹
```
